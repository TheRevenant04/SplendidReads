{% extends 'base.html' %}

{% block content %}
    <div class="container">
        <div class="row mt-3">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">SKU</th>
                            <th scope="col">Title</th>
                            <th scope="col">Author</th>
                            <th scope="col">Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if cart %}
                            {% for item in cart %}
                                <tr>
                                    <th scope="row">{{forloop.counter}}</th>
                                    <td>{{item.product.SKU}}</td>
                                    <td>{{item.product.Title}}</td>
                                    <td>{{item.product.Author}}</td>
                                    <td>₹{{item.product.Price}}</td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <th scope="row">1</th>
                                <td>{{product.SKU}}</td>
                                <td>{{product.Title}}</td>
                                <td>{{product.Author}}</td>
                                <td>₹{{product.Price}}</td>
                            </tr>
                        {% endif %}
                        <tr>
                          <th colspan="4"scope="row">Total</th>
                          <td><strong>₹{{total_amount}}</strong</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row justify-content-end">
            <form action="{% if cart %}{% url 'Payments:cart_payment_status'%}{% else %}{% url 'Payments:quick_payment_status' pk=pk %}{% endif %}" method="POST">
            {% csrf_token %}
                <script
                    src="https://checkout.razorpay.com/v1/checkout.js"
                    data-key="Your API key" // Enter the Test API Key ID generated from Dashboard → Settings → API Keys
                    data-amount="{{amount_paise}}" // Amount is in currency subunits. Hence, 29935 refers to 29935 paise or ₹299.35.
                    data-currency="INR"//You can accept international payments by changing the currency code. Contact our Support Team to enable International for your account
                    data-order_id="{{order_id}}"//Replace with the order_id generated by you in the backend.
                    data-buttontext="Pay with Razorpay"
                    data-name="SplendidReads"
                    data-prefill.name="{{request.user.get_full_name}}"
                    data-prefill.email="{{request.user.email}}"
                    data-theme.color="#FB8122">
                </script>
                <input type="hidden" custom="Hidden Element" name="hidden">
            </form>
        </div>
    </div>
{% endblock %}
